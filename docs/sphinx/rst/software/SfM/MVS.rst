
*************************************
Multiple View Stereovision
*************************************

Once camera position and orientation have been computed, Multiple View Stereo-vision algorithms could be used 
to compute a dense scene representation, such as:

- dense point cloud,
- surface and texture.


Export to PMVS/CMVS
========================

OpenMVG exports [PMVS]_ ready to use project (images, projection matrices and pmvs_options.txt files).

Once a 3D calibration have been computed you can convert the SfM_Ouput files to a PMVS project.

.. code-block:: c++

  $ openMVG_main_openMVG2PMVS -i Dataset/outReconstruction/SfM_Output/ -o Dataset/outReconstruction/SfM_Output/
  $ pmvs Dataset/outReconstruction/SfM_Output/PMVS/ pmvs_options.txt
  
- Optional arguments for openMVG_main_openMVG2PMVS
 
  - **-i** sfm input directory
  - **-o** sfm output directory
  - **-r** resolution (equivalent to "level" parameter generated by CMVS genOption for PMVS)
   
    "The software internally builds an image pyramid, and this parameter specifies the level in the 
    image pyramid that is used for the computation. When level is 0, original (full) resolution images are used. 
    When level is 1, images are halved (or 4 times less pixels). When level is 2, images are 4 times smaller (or 16 times less pixels). 
    In general, level = 1 is suggested, because cameras typically do not have r,g,b censors [sic] for each pixel (bayer pattern). 
    Note that increasing the value of level significantlly speeds-up the whole computation, 
    while reconstructions become significantly sparse." [http://www.di.ens.fr/pmvs/documentation.html]
    
  - **-c** number of cores (equivalent to "CPU" parameter generated by CMVS genOption for PMVS)
  
    "The software (CMVS) supports threading, and you can specify the number of (virtual) CPUs in your machine. 
    For example, if you have dual dual-core Xeon. You should set CPU=4." [http://www.di.ens.fr/pmvs/documentation.html]



.. figure:: resultOutput.png
   :align: center

   Figure: Multiple View Stereo-vision point cloud densification on the estimated scene using [PMVS]_.

In order to use CMVS for large scene openMVG2PMVS export also the scene in the Bundler output format.

.. code-block:: c++

  $ openMVG_main_openMVG2PMVS -i Dataset/outReconstruction/SfM_Output/ -o Dataset/outReconstruction/SfM_Output/
  $ cmvs Dataset/outReconstruction/SfM_Output/PMVS/ [MaxImageCountByCluster=100]
  $ cmvs Dataset/outReconstruction/SfM_Output/PMVS/ 30
  $ genOption Dataset/outReconstruction/SfM_Output/PMVS/
  $ sh Dataset/outReconstruction/SfM_Output/PMVS/pmvs.sh


Export to CMPMVS
========================

OpenMVG exports [CMPMVS]_ ready to use project (images, projection matrices and ini configuration file).

.. code-block:: c++

  $ openMVG_main_openMVG2CMPMVS -i Dataset/outReconstruction/SfM_Output/ -o Dataset/outReconstruction/SfM_Output/

